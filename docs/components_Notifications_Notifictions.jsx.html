<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Notifications/Notifictions.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Notifications/Notifictions.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect } from "react";
import styles from "./Notifications.module.css";
import pen from "../../assets/Images/pencil-64x64.png";
import userPhoto from "../../assets/Images/myphoto.jpg";
import axios from "axios";

/**
 * Component to render the Notifications  in the Settings page
 * @author Abdalla Mahmoud
 *
 * @component
 */

function Notifictions() {
  const [userSettings, updateInfo] = useState({
    EmailUserAboutNewFollowersBox: null,
    EmailUserAboutNewRepliesBox: null,
    EmailUserAboutNewMentionsBox: null,
    EmailUserAboutNewAnsweredAsksBox: null,
    NotificationSettingsFor: "From people you follow",
    ApplySettingsForAllBlogs: null,
  });

  /**
   *
   * this function is responsible for changing the value of the states ojbect
   * @type {function}
   * @param {*} event
   * @returns {void}
   *
   */
  const inputsOnChange = (event) => {
    /**
     * get all the checkboxes input in the notifications section
     * @type {Array&lt;Element>}
     *
     */
    let checkboxes = document.querySelectorAll(`input[type="checkbox"]`);

    if (event.target === checkboxes[0]) {
      updateInfo({
        ...userSettings,
        ApplySettingsForAllBlogs: event.target.checked,
      });
    } else if (event.target === checkboxes[1]) {
      updateInfo({
        ...userSettings,
        EmailUserAboutNewFollowersBox: event.target.checked,
      });
    } else if (event.target === checkboxes[2]) {
      updateInfo({
        ...userSettings,
        EmailUserAboutNewRepliesBox: event.target.checked,
      });
    } else if (event.target === checkboxes[3]) {
      updateInfo({
        ...userSettings,
        EmailUserAboutNewMentionsBox: event.target.checked,
      });
    } else if (event.target === checkboxes[4]) {
      updateInfo({
        ...userSettings,
        EmailUserAboutNewAnsweredAsksBox: event.target.checked,
      });
    } else {
      if (event.target.value === "1") {
        updateInfo({ ...userSettings, NotificationSettingsFor: "From nobody" });

        document.querySelector(`.${styles["arrow"]}`).style.left = "-55px";
      } else if (event.target.value === "2") {
        updateInfo({
          ...userSettings,
          NotificationSettingsFor: "From people you follow",
        });

        document.querySelector(`.${styles["arrow"]}`).style.left = "0";
      } else {
        updateInfo({
          ...userSettings,
          NotificationSettingsFor: "From everyone",
        });
        document.querySelector(`.${styles["arrow"]}`).style.left = "-50px";
      }
    }
  };

  /**
   * handle the action when the edit button is clicked
   * @type {function}
   * @param {*} event
   * @returns {void}
   *
   */
  const editButtonOnClick = (event) => {
    document.querySelector("form").style.display = "block";
    document.querySelector(`.${styles["icon-photo"]}`).style.display = "none";
    document.querySelector(
      `.${styles["icon-photo"]}`
    ).previousSibling.style.display = "none";
    document.querySelector(`.${styles["edit-after-click"]}`).style.display =
      "flex";
  };

  /**
   *  handle the action when the cancel button is clicked
   * @type {function}
   * @param {void }
   * @returns {void}
   *
   */
  const cancelButtonOnClick = (event) => {
    document.querySelector("form").style.display = "none";
    document.querySelector(`.${styles["icon-photo"]}`).style.display = "block";
    document.querySelector(
      `.${styles["icon-photo"]}`
    ).previousSibling.style.display = "block";
    document.querySelector(`.${styles["edit-after-click"]}`).style.display =
      "none";
    event.preventDefault();
  };

  /**
   * handle the action when the "Apply on All" button is clicked
   * @type {function}
   * @param {*}event
   * @returns {void}
   *
   */
  const applyForAllButtonOnClick = (event) => {
    let saveButton = document.querySelector(`.${styles["save-button"]}`);
    if (saveButton.innerHTML === "Save") saveButton.innerHTML = "Save For All ";
    else {
      saveButton.innerHTML = "Save";
    }
  };

  /**
   * retreive the data from the backend when the component mounted
   * @type {function}
   * @param {void}
   * @returns {void}
   *
   */
  const componentDidMount = () => {
    axios
      .get("http://localhost:3000/users/1")
      .then((response) => {
        let PrevUserSettings = response.data.notificationsSettings;
        let userBoxes = document.querySelectorAll(`input[type="checkbox"]`);
        PrevUserSettings.ApplySettingsForAllBlogs = false;
        updateInfo(PrevUserSettings);
        userBoxes[1].checked =
          PrevUserSettings["EmailUserAboutNewFollowersBox"];
        userBoxes[2].checked = PrevUserSettings["EmailUserAboutNewRepliesBox"];
        userBoxes[3].checked = PrevUserSettings["EmailUserAboutNewMentionsBox"];
        userBoxes[4].checked =
          PrevUserSettings["EmailUserAboutNewAnsweredAsksBox"];

        /**
         * get the selection box
         * @type {Array&lt;Element>}
         *
         */
        let selectionBox = document.querySelector("select");
        if (PrevUserSettings.NotificationSettingsFor === "From nobody") {
          selectionBox.value = 1;
          selectionBox.nextElementSibling.style.left = "-55px";
        } else if (
          PrevUserSettings.NotificationSettingsFor === "From people you follow"
        ) {
          selectionBox.value = 2;
          selectionBox.nextElementSibling.style.left = "0";
        } else {
          selectionBox.value = 3;
          selectionBox.nextElementSibling.style.left = "-50px";
        }
      })
      .catch((err) => {
        console.log(err);
      });
  };

  /**
   * this function handle the Action when the user submit the data
   * @type {function}
   * @param {void  }
   * @returns {void}
   *
   */
  const formAction = () => {
    let sentData = { notificationsSettings: userSettings };
    axios
      .patch("http://localhost:3000/users/1", sentData)
      .then((res) => {
        // window.location.reload();
        console.log(res);
      })
      .catch((err) => {
        console.log(err);
        // validations from backend .
      });
    this.preventDefault();
  };
  useEffect(componentDidMount, []);
  return (
    &lt;div className={styles["notification-container"]}>
      &lt;h1 className={styles["header"]}>Notifications&lt;/h1>
      &lt;hr />
      &lt;div className={styles["notification-section"]}>
        &lt;div className={styles["user-info"]}>
          &lt;img
            src={userPhoto}
            alt=""
            className={styles["user-img"]}
            data-testid="avatar-icon"
          />
          &lt;div className={styles["user-name"]}>Thebrownboy&lt;/div>
        &lt;/div>
        &lt;div className={styles["edit-section"]}>
          &lt;div style={{ whiteSpace: "nowrap", marginRight: "10px" }}>
            {" "}
            Some notification and some emails
          &lt;/div>

          &lt;img
            className={styles["icon-photo"]}
            src={pen}
            alt=""
            onClick={editButtonOnClick}
            data-testid="notifications-section-edit-button"
          />
          &lt;div
            style={{ display: "none" }}
            className={styles["edit-after-click"]}
          >
            &lt;input
              onChange={inputsOnChange}
              type="checkbox"
              onClick={applyForAllButtonOnClick}
              data-testid="apply-for-all-checkbox"
            />
            &lt;div style={{ height: "fit-content", marginTop: "6px" }}>
              Apply settings to all blogs{" "}
            &lt;/div>
          &lt;/div>
        &lt;/div>
      &lt;/div>

      &lt;form
        style={{ display: "none", marginTop: "20px", color: "#444" }}
        data-testid="notifications-form"
      >
        &lt;div style={{ display: "flex" }}>
          &lt;div className={styles["notification-section-title"]}>
            Email me about{" "}
          &lt;/div>
          &lt;div>
            &lt;div style={{ display: "flex" }}>
              &lt;input
                type="checkbox"
                onChange={inputsOnChange}
                data-testid="new-followers-checkbox"
              />
              &lt;div className={styles["notification-selection"]}>
                New Followers
              &lt;/div>
            &lt;/div>
            &lt;div style={{ display: "flex" }}>
              &lt;input
                type="checkbox"
                onChange={inputsOnChange}
                data-testid="new-replies-checkbox"
              />
              &lt;div className={styles["notification-selection"]}>
                New replies
              &lt;/div>
            &lt;/div>
            &lt;div style={{ display: "flex" }}>
              &lt;input
                type="checkbox"
                onChange={inputsOnChange}
                data-testid="mentions-checkbox"
              />
              &lt;div className={styles["notification-selection"]}>Mentions&lt;/div>
            &lt;/div>
            &lt;div style={{ display: "flex" }} onChange={inputsOnChange}>
              &lt;input type="checkbox" data-testid="answered-asks-checkbox" />
              &lt;div className={styles["notification-selection"]}>
                Answered Asks
              &lt;/div>
            &lt;/div>
          &lt;/div>
        &lt;/div>
        &lt;div
          style={{
            display: "flex",
            margin: "15px 0 ",
          }}
        >
          &lt;div className={styles["notification-section-title"]} style={{}}>
            {" "}
            Notifications
          &lt;/div>
          &lt;div style={{ marginBottom: "15px" }} className={styles["selected"]}>
            &lt;div style={{ display: "flex", alignItems: "center" }}>
              &lt;select
                name=""
                id=""
                onChange={inputsOnChange}
                data-testid="notifications-selection-box"
              >
                &lt;option value="1">From nobody&lt;/option>
                &lt;option value="2">From people you follow&lt;/option>
                &lt;option value="3">From everyone&lt;/option>
              &lt;/select>
              &lt;div className={styles["arrow"]}>^&lt;/div>
            &lt;/div>
          &lt;/div>
        &lt;/div>
        &lt;div
          style={{
            marginLeft: "35%",
            // this is margin to be indented  with the sections above
            // 35% = 30% margin left of the title above + 30% width of the title above
          }}
        >
          &lt;button
            onClick={cancelButtonOnClick}
            className={styles["cancel-button"]}
            data-testid="notifications-cancel-button"
          >
            Cancel
          &lt;/button>
          &lt;button
            onClick={formAction}
            className={styles["save-button"]}
            data-testid="notifications-save-button"
          >
            Save
          &lt;/button>
        &lt;/div>
      &lt;/form>
    &lt;/div>
  );
}

export default Notifictions;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="FilterSection.html">FilterSection</a></li><li><a href="module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#EmailSection">EmailSection</a></li><li><a href="global.html#Interface">Interface</a></li><li><a href="global.html#Notifictions">Notifictions</a></li><li><a href="global.html#PasswordSection">PasswordSection</a></li><li><a href="global.html#Preferences">Preferences</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#SecuritySection">SecuritySection</a></li><li><a href="global.html#Settings">Settings</a></li><li><a href="global.html#Sounds">Sounds</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Sat Nov 20 2021 17:51:39 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
